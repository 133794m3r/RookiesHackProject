var columns={},column_keys=[];function onFormSubmit(a){update_all_entries()}function get_column_names(){values=SpreadsheetApp.getActive().getSheetByName("Form Responses").getRange("A1:K1").getValues();for(var a=0;10>=a;a++)column_keys[a]=values[0][a]}
function concatenate_addresses(){var a=SpreadsheetApp.getActive().getSheetByName("Form Responses"),b=a.getMaxRows()-2,c=a.getRange(2,5,b,4).getValues(),d=Array(1),e=2,f=Array(b);for(i=0;i<b;i++)f[i]=Array(1),""==c[i][3]&&(E=c[i][0],address+=""!=E?E+",":"",F=c[i][1],address+=""!=F?F+",":"",G=c[i][2],address+=""!=G?G:"",d[0]=address,a.getRange("H"+e).setValue(d)),f[i]=address,e++;return f}function fetch(a,b){return UrlFetchApp.fetch(a,b)}function get_json(a){return JSON.parse(a).results[0]}
function latitude(a){return a.geometry.location.lat}function longitude(a){return a.geometry.location.lng}function __mark_stale(){var a=SpreadsheetApp.getActive().getSheetByName("Form Responses");max=a.getMaxRows()-1;for(var b=Array(max),c=0;c<max;c++)b[c]=["Y"];a.getRange("K2:K").setValues(b)}
function update_all_entries(){var a=concatenate_addresses(),b=SpreadsheetApp.getActive().getSheetByName("Form Responses"),c=b.getMaxRows()-2,d,e=2;Logger.log(c);var f=b.getRange(2,8,c,2).getValues(),h=Array(1);h[0]=Array(2);for(d=0;d<c;d++){if(""==f[d][0]||""==f[d][1]){var g=a[d];g=fetch("https://maps.googleapis.com/maps/api/geocode/json?key=PLACE_YOUR_API_KEY_HERE&address="+g);var k=get_json(g.getContentText());g=latitude(k);k=longitude(k);h[0][0]=g;h[0][1]=k;b.getRange("I"+e+":J"+e).setValues(h)}e++}}
;
